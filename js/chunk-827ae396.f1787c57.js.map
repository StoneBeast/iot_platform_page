{"version":3,"sources":["webpack:///./src/apis/product.js","webpack:///./src/components/mainAppHeader.vue","webpack:///./src/views/product/component/lineChart.vue?7c36","webpack:///./src/components/mainAppHeader.vue?d5c9","webpack:///./src/views/product/index.vue?b002","webpack:///./src/views/product/component/lineChart.vue","webpack:///./src/views/product/component/lineChart.vue?00f3","webpack:///./src/views/product/component/productInfoDrawer.vue","webpack:///./src/views/product/component/productInfoDrawer.vue?8e42","webpack:///./src/views/product/index.vue","webpack:///./src/views/product/index.vue?fabc"],"names":["fetchProductList","params","request","url","method","addUpdateProduct","data","deleteProduct","fetchProductData","fetchEditOptions","fetchConnectedDevice","fetchUploadDeviceCount","__exports__","routerStore","useRouterStore","isLoading","ref","start","Date","now","end","reactive","productId","chart","myChart","initChart","value","option","title","text","tooltip","trigger","axisPointer","type","animation","xAxis","boundaryGap","name","nameTextStyle","fontStyle","fontWeight","fontSize","axisLine","symbol","yAxis","show","series","symbolSize","lineStyle","width","smooth","then","res","map","item","formatDate","date","newCount","setOption","updateChart","newOption","datalist","onMounted","echarts","init","watch","props","chartTitle","computed","isBrowse","isShowDrawer","getProductData","productData","productName","productIndustry","productType","productAbout","accessNetworks","accessAgreement","drawerSwitch","options","industryOptions","productTypeOptions","accessAgreementOptions","rules","required","message","min","max","handleCancel","isButtonLoading","handleUpdate","code","ElMessage","emit","deviceCount","newConnect","onlineDevice","uploadDataDevice","todayUploadData","uploadDataTotalCount","initData","fetchDeviceStatus","deviceId","forEach","deviceStatus","todayUploadDevice","totalCount","initPage","getProductInfo","deviceConnect","classList","contains","add","timer","getDataTimer","setTimeout","finally","onUnmounted","clearTimeout","handleOpenInfo","handleOpenEdit","deviceData","handleChangeOption","target","other","remove"],"mappings":"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","file":"js/chunk-827ae396.f1787c57.js","sourcesContent":["import request from '@/utils/axios'\r\n\r\nexport function fetchProductList(params) {\r\n  return request({\r\n    url: '/api/data/fetchProductList',\r\n    method: 'GET',\r\n    params\r\n  })\r\n}\r\n\r\nexport function addUpdateProduct(data) {\r\n  return request({\r\n    url: '/api/data/addUpdateProduct',\r\n    method: 'POST',\r\n    data\r\n  })\r\n}\r\n\r\nexport function deleteProduct(params) {\r\n  return request({\r\n    url: '/api/data/deleteProduct',\r\n    method: 'DELETE',\r\n    params\r\n  })\r\n}\r\n\r\nexport function fetchProductData(params) {\r\n  return request({\r\n    url: '/api/data/fetchProductData',\r\n    method: 'GET',\r\n    params\r\n  })\r\n}\r\n\r\nexport function fetchEditOptions() {\r\n  return request({\r\n    url: '/api/data/fetchEditOptions',\r\n    method: 'GET'\r\n  })\r\n}\r\n\r\nexport function fetchConnectedDevice(params) {\r\n  return request({\r\n    url: '/api/data/fetchConnectedDevice',\r\n    method: 'GET',\r\n    params\r\n  })\r\n}\r\n\r\nexport function fetchUploadDeviceCount(params) {\r\n  return request({\r\n    url: '/api/data/fetchUploadDeviceCount',\r\n    method: 'GET',\r\n    params\r\n  })\r\n}\r\n","import script from \"./mainAppHeader.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./mainAppHeader.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./mainAppHeader.vue?vue&type=style&index=0&id=4b858026&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\javaWeb\\\\vuePro\\\\xin_gong_ke\\\\iot-page\\\\node_modules\\\\.pnpm\\\\vue-loader@16.8.3_5vqgdkn543z7gobmtemdwwisxa\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4b858026\"]])\n\nexport default __exports__","export * from \"-!../../../../node_modules/.pnpm/mini-css-extract-plugin@0.9.0_webpack@4.46.0/node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../../node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../../node_modules/.pnpm/vue-loader@16.8.3_5vqgdkn543z7gobmtemdwwisxa/node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../../node_modules/.pnpm/cache-loader@4.1.0_webpack@4.46.0/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/.pnpm/vue-loader@16.8.3_5vqgdkn543z7gobmtemdwwisxa/node_modules/vue-loader/dist/index.js??ref--1-1!./lineChart.vue?vue&type=style&index=0&id=666f9aa3&scoped=true&lang=css\"","export * from \"-!../../node_modules/.pnpm/mini-css-extract-plugin@0.9.0_webpack@4.46.0/node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/.pnpm/vue-loader@16.8.3_5vqgdkn543z7gobmtemdwwisxa/node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/.pnpm/cache-loader@4.1.0_webpack@4.46.0/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/.pnpm/vue-loader@16.8.3_5vqgdkn543z7gobmtemdwwisxa/node_modules/vue-loader/dist/index.js??ref--1-1!./mainAppHeader.vue?vue&type=style&index=0&id=4b858026&scoped=true&lang=css\"","export * from \"-!../../../node_modules/.pnpm/mini-css-extract-plugin@0.9.0_webpack@4.46.0/node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/.pnpm/vue-loader@16.8.3_5vqgdkn543z7gobmtemdwwisxa/node_modules/vue-loader/dist/stylePostLoader.js!../../../node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/.pnpm/cache-loader@4.1.0_webpack@4.46.0/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/.pnpm/vue-loader@16.8.3_5vqgdkn543z7gobmtemdwwisxa/node_modules/vue-loader/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=173d6202&scoped=true&lang=css\"","<template>\r\n  <div id=\"container-box-chart\" ref=\"chart\" v-loading=\"isLoading\" />\r\n</template>\r\n\r\n<script setup>\r\nimport echarts from '@/utils/echarts'\r\nimport { ref, onMounted, defineProps, watch, reactive } from 'vue'\r\nimport { fetchConnectedDevice, fetchUploadDeviceCount } from '@/apis/product'\r\nimport { useRouterStore } from '@/store/router'\r\nimport { formatDate } from '@/utils/formatDate'\r\n\r\nconst props = defineProps({\r\n  chartTitle: {\r\n    type: String,\r\n    default: '设备接入统计'\r\n  }\r\n})\r\nconst routerStore = useRouterStore()\r\nconst isLoading = ref(false)\r\n\r\nconst start = (Date.now() - 7 * 24 * 3600 * 1000)\r\nconst end = Date.now()\r\n\r\nconst params = reactive({\r\n  start: start,\r\n  end: end,\r\n  productId: routerStore.productId\r\n})\r\n\r\nconst chart = ref(null)\r\nlet myChart\r\nonMounted(() => {\r\n  myChart = echarts.init(chart.value)\r\n  initChart(myChart)\r\n})\r\nwatch(\r\n  () => props.chartTitle,\r\n  () => {\r\n    updateChart(props.chartTitle, myChart)\r\n  }\r\n)\r\n\r\nfunction initChart(chart) {\r\n  isLoading.value = true\r\n  const option = {\r\n    title: {\r\n      text: '设备接入统计'\r\n    },\r\n    tooltip: {\r\n      trigger: 'axis',\r\n      axisPointer: {\r\n        type: 'cross'\r\n      }\r\n    },\r\n    animation: true,\r\n    xAxis: {\r\n      type: 'category',\r\n      boundaryGap: false,\r\n      name: '时间',\r\n      data: [],\r\n      nameTextStyle: {\r\n        fontStyle: 'italic',\r\n        fontWeight: 'bold',\r\n        fontSize: 15\r\n      },\r\n      axisLine: {\r\n        symbol: ['none', 'arrow']\r\n      }\r\n    },\r\n    yAxis: {\r\n      type: 'value',\r\n      name: '数量(个)',\r\n      nameTextStyle: {\r\n        fontStyle: 'italic',\r\n        fontWeight: 'bold',\r\n        fontSize: 15\r\n      },\r\n      axisLine: {\r\n        show: true,\r\n        symbol: ['none', 'arrow']\r\n      }\r\n    },\r\n    series: [\r\n      {\r\n        data: [],\r\n        name: '新接入设备数',\r\n        type: 'line',\r\n        symbolSize: 10,\r\n        lineStyle: {\r\n          width: 6\r\n        },\r\n        smooth: true\r\n      }\r\n    ]\r\n  }\r\n  fetchConnectedDevice(params).then(res => {\r\n    option.xAxis.data = res.data.map(item => formatDate(item.date, 'YY-MM-DD'))\r\n    option.series[0].data = res.data.map(item => item.newCount)\r\n    chart.setOption(option)\r\n    isLoading.value = false\r\n  })\r\n}\r\nfunction updateChart(title, chart) {\r\n  isLoading.value = true\r\n  const newOption = {\r\n    title: {\r\n      text: title\r\n    },\r\n    xAxis: {\r\n      data: []\r\n    },\r\n    series: [\r\n      {\r\n        name: '',\r\n        data: []\r\n      }\r\n    ]\r\n  }\r\n  if (title === '设备接入统计') {\r\n    fetchConnectedDevice(params).then(res => {\r\n      newOption.xAxis.data = res.data.map(item => formatDate(item.date))\r\n      newOption.series[0].data = res.data.map(item => item.newCount)\r\n      newOption.series[0].name = '新接入设备数'\r\n      chart.setOption(newOption)\r\n\r\n      isLoading.value = false\r\n    })\r\n  } else {\r\n    fetchUploadDeviceCount(params).then(res => {\r\n      newOption.xAxis.data = res.data.datalist.map(item => formatDate(item.date))\r\n      newOption.series[0].data = res.data.datalist.map(item => item.newCount)\r\n      newOption.series[0].name = '新上传数据数'\r\n      chart.setOption(newOption)\r\n\r\n      isLoading.value = false\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n#container-box-chart {\r\n  width: 100%;\r\n  height: 300px;\r\n}\r\n</style>\r\n","import script from \"./lineChart.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./lineChart.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./lineChart.vue?vue&type=style&index=0&id=666f9aa3&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\javaWeb\\\\vuePro\\\\xin_gong_ke\\\\iot-page\\\\node_modules\\\\.pnpm\\\\vue-loader@16.8.3_5vqgdkn543z7gobmtemdwwisxa\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-666f9aa3\"]])\n\nexport default __exports__","<template>\r\n  <el-drawer v-model=\"isShowDrawer\" :direction=\"'rtl'\">\r\n    <template #header>\r\n      <div>\r\n        <h2>{{ title }}</h2>\r\n        <hr color=\"#e8eaec\">\r\n      </div>\r\n    </template>\r\n    <template #default>\r\n      <div>\r\n        <h3>产品信息</h3>\r\n        <el-form ref=\"createFrom\" :model=\"productData\" :label-position=\"'top'\" :rules=\"rules\">\r\n          <el-form-item label=\"产品名称\" prop=\"productName\">\r\n            <el-input v-model=\"productData.productName\" placeholder=\"请输入产品名称\" :disabled=\"props.isBrowse\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"产品行业\" prop=\"productIndustry\">\r\n            <el-select v-model=\"productData.productIndustry\" placeholder=\"选择产品行业\" :disabled=\"props.isBrowse\">\r\n              <el-option v-for=\"(item, index) in options.industryOptions\" :key=\"index\" :label=\"item\" :value=\"item\" />\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item label=\"产品类别\" prop=\"productType\">\r\n            <el-select v-model=\"productData.productType\" placeholder=\"选择产品类别\" :disabled=\"props.isBrowse\">\r\n              <el-option v-for=\"(item, index) in options.productTypeOptions\" :key=\"index\" :label=\"item\" :value=\"item\" />\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item label=\"产品简介:\" prop=\"productAbout\">\r\n            <el-input v-model=\"productData.productAbout\" type=\"textarea\" placeholder=\"产品简介\" :autosize=\"{ minRows: 5,maxRows: 7 }\" :disabled=\"props.isBrowse\" />\r\n          </el-form-item>\r\n          <hr color=\"#e8eaec\">\r\n          <h3>技术参数</h3>\r\n          <el-form-item label=\"联网方式:\" prop=\"accessNetworks\">\r\n            <el-radio-group v-model=\"productData.accessNetworks\" :disabled=\"props.isBrowse\">\r\n              <el-radio label=\"蜂窝网络\" />\r\n              <el-radio label=\"wifi\" />\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item label=\"设备接入协议\" prop=\"accessAgreement\">\r\n            <el-select v-model=\"productData.accessAgreement\" placeholder=\"选择接入协议\" :disabled=\"props.isBrowse\">\r\n              <el-option v-for=\"(item, index) in options.accessAgreementOptions\" :key=\"index\" :label=\"item\" :value=\"item\" />\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n    </template>\r\n    <template #footer>\r\n      <div style=\"flex: auto\">\r\n        <el-button @click=\"handleCancel\">取消</el-button>\r\n        <el-button type=\"primary\" :loading=\"isButtonLoading\" @click=\"handleUpdate\">确认</el-button>\r\n      </div>\r\n    </template>\r\n  </el-drawer>\r\n</template>\r\n\r\n<script setup>\r\nimport { defineProps, reactive, computed, ref, watch, onMounted, defineEmits } from 'vue'\r\nimport { fetchEditOptions, fetchProductData, addUpdateProduct } from '@/apis/product'\r\nimport { useRouterStore } from '@/store/router'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nconst props = defineProps({\r\n  productId: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  isBrowse: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  drawerSwitch: {\r\n    type: Boolean,\r\n    default: true\r\n  }\r\n})\r\nconst emit = defineEmits(['updateInfo'])\r\nconst routerStore = useRouterStore()\r\nconst title = computed(() => {\r\n  if (!props.isBrowse) {\r\n    return '编辑信息'\r\n  } else {\r\n    return '产品信息'\r\n  }\r\n})\r\nconst isShowDrawer = ref(false)\r\n\r\nfunction getProductData() {\r\n  fetchProductData({ productId: routerStore.productId }).then(res => {\r\n    productData.productId = res.data.productId\r\n    productData.productName = res.data.productName\r\n    productData.productIndustry = res.data.productIndustry\r\n    productData.productType = res.data.productType\r\n    productData.productAbout = res.data.productAbout\r\n    productData.accessNetworks = res.data.accessNetworks\r\n    productData.accessAgreement = res.data.accessAgreement\r\n    isShowDrawer.value = true\r\n  })\r\n}\r\nwatch(\r\n  () => props.drawerSwitch,\r\n  () => { getProductData() }\r\n)\r\nconst productData = reactive({\r\n  productId: '',\r\n  productName: '',\r\n  productIndustry: '',\r\n  productType: '',\r\n  productAbout: '',\r\n  accessNetworks: '',\r\n  accessAgreement: ''\r\n})\r\n\r\nconst options = reactive({\r\n  industryOptions: [],\r\n  productTypeOptions: [],\r\n  accessAgreementOptions: []\r\n})\r\n\r\nonMounted(() => {\r\n  fetchEditOptions().then(res => {\r\n    options.industryOptions = res.data.industryOptions\r\n    options.productTypeOptions = res.data.productTypeOptions\r\n    options.accessAgreementOptions = res.data.accessAgreementOptions\r\n  })\r\n})\r\n\r\nconst rules = reactive({\r\n  productName: [\r\n    { required: true, message: '产品名称不能为空', trigger: 'blur' },\r\n    { min: 2, max: 15, message: '长度为2-15个字符', trigger: 'blur' }\r\n  ],\r\n  productIndustry: [\r\n    {\r\n      required: true,\r\n      message: '产品行业不能为空',\r\n      trigger: 'blur'\r\n    }\r\n  ],\r\n  productType: [\r\n    {\r\n      required: true,\r\n      message: '产品类别不能为空',\r\n      trigger: 'blur'\r\n    }\r\n  ],\r\n  accessNetworks: [\r\n    {\r\n      required: true,\r\n      message: '联网方式不能为空',\r\n      trigger: 'blur'\r\n    }\r\n  ],\r\n  accessAgreement: [\r\n    {\r\n      required: true,\r\n      message: '设备接入协议不能为空',\r\n      trigger: 'blur'\r\n    }\r\n  ]\r\n})\r\n\r\nfunction handleCancel() {\r\n  isShowDrawer.value = false\r\n}\r\n\r\nconst isButtonLoading = ref(false)\r\nfunction handleUpdate() {\r\n  if (!props.isBrowse) {\r\n    isButtonLoading.value = true\r\n    addUpdateProduct(productData).then(res => {\r\n      if (res.code === 200) {\r\n        ElMessage({\r\n          type: 'success',\r\n          message: '修改成功'\r\n        })\r\n        emit('updateInfo')\r\n        // getProductData()\r\n        isShowDrawer.value = false\r\n      }\r\n      isButtonLoading.value = false\r\n    })\r\n  } else {\r\n    isShowDrawer.value = false\r\n  }\r\n}\r\n</script>\r\n","import script from \"./productInfoDrawer.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./productInfoDrawer.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\r\n  <div id=\"container-product\" v-loading=\"isLoading\">\r\n    <product-info-drawer :drawer-switch=\"drawerSwitch\" :is-browse=\"isBrowse\" @update-info=\"getProductInfo\" />\r\n    <main-app-header page-title=\"产品详情\" />\r\n    <div id=\"container-product-info\" class=\"container-context\">\r\n      <el-row justify=\"center\">\r\n        <el-col class=\"text-container-title text-container-first\" :span=\"12\">{{ productData.productName }}</el-col>\r\n        <el-col class=\"text-container-title\" :span=\"3\">产品ID</el-col>\r\n        <!--        <el-col class=\"text-container-title\" :span=\"3\">用户ID</el-col>-->\r\n        <el-col class=\"text-container-title\" :span=\"3\">占位</el-col>\r\n        <el-col class=\"text-container-title\" :span=\"3\">占位</el-col>\r\n        <el-col class=\"text-container-title\" :span=\"3\">接入协议</el-col>\r\n      </el-row>\r\n      <el-row justify=\"center\">\r\n        <el-col class=\"text-container-content text-container-first\" :span=\"12\"><el-tag>{{ productData.productType }}</el-tag><span style=\"cursor: pointer\" @click=\"handleOpenInfo\">详情</span><span style=\"cursor: pointer\" @click=\"handleOpenEdit\">编辑</span></el-col>\r\n        <el-col class=\"text-container-content\" :span=\"3\">{{ productData.productId }}</el-col>\r\n        <!--        <el-col class=\"text-container-content\" :span=\"3\">515468</el-col>-->\r\n        <el-col class=\"text-container-content\" :span=\"3\">temp</el-col>\r\n        <el-col class=\"text-container-content\" :span=\"3\">temp</el-col>\r\n        <el-col class=\"text-container-content\" :span=\"3\">{{ productData.accessAgreement }}</el-col>\r\n      </el-row>\r\n    </div>\r\n    <div id=\"container-option\">\r\n      <div id=\"container-connect-device\" ref=\"deviceConnect\" class=\"container-info-device container-context\" @click=\"handleChangeOption(deviceConnect, deviceData, '设备接入统计')\">\r\n        <div class=\"container-info-device-left\">\r\n          <div class=\"iconfont icon-device\" />\r\n          <span>接入设备总数</span><br><span>{{ productData.deviceCount }}</span>\r\n        </div>\r\n        <div class=\"container-info-device-right-top\">\r\n          <span>当前在线设备</span><br>\r\n          <span>{{ onlineDevice }}</span>\r\n        </div>\r\n        <div class=\"container-info-device-right-bottom\">\r\n          <span>今日新增设备</span><br>\r\n          <span>{{ newConnect }}</span>\r\n        </div>\r\n      </div>\r\n      <div id=\"container-data-device\" ref=\"deviceData\" class=\"container-info-device container-context\" @click=\"handleChangeOption(deviceData, deviceConnect, '上传数据统计')\">\r\n        <div class=\"container-info-device-left\">\r\n          <div class=\"iconfont icon-data-device\" />\r\n          <span>上传数据总数</span><br><span>{{ uploadDataTotalCount }}</span>\r\n        </div>\r\n        <div class=\"container-info-device-right-top\">\r\n          <span>今日上传数据数</span><br>\r\n          <span>{{ todayUploadData }}</span>\r\n        </div>\r\n        <div class=\"container-info-device-right-bottom\">\r\n          <span>今日上传数据设备</span><br>\r\n          <span>{{ uploadDataDevice }}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div id=\"container-chart\" class=\"container-context\">\r\n      <line-chart :chart-title=\"chartTitle\" />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport MainAppHeader from '@/components/mainAppHeader'\r\nimport LineChart from '@/views/product/component/lineChart'\r\nimport ProductInfoDrawer from '@/views/product/component/productInfoDrawer'\r\nimport { fetchProductData, fetchConnectedDevice, fetchUploadDeviceCount } from '@/apis/product'\r\nimport { fetchDeviceStatus } from '@/apis/device'\r\nimport { reactive, onMounted, ref, onUnmounted } from 'vue'\r\nimport { useRouterStore } from '@/store/router'\r\n\r\nconst isLoading = ref(false)\r\nconst productData = reactive({\r\n  productName: '',\r\n  productId: '',\r\n  productType: '',\r\n  accessAgreement: '',\r\n  deviceCount: ''\r\n})\r\n\r\nconst start = (Date.now() - 24 * 3600 * 1000 * 7)\r\nconst end = Date.now()\r\nconst routerStore = useRouterStore()\r\nconst params = reactive({\r\n  start: start,\r\n  end: end,\r\n  productId: routerStore.productId\r\n})\r\nconst newConnect = ref(0)\r\nconst onlineDevice = ref(0)\r\nconst uploadDataDevice = ref(0)\r\nconst todayUploadData = ref(0)\r\nconst uploadDataTotalCount = ref(0)\r\n\r\nfunction initData() {\r\n  fetchConnectedDevice(params).then(res => {\r\n    if (res.code === 200) {\r\n      newConnect.value = res.data[7].newCount\r\n    }\r\n  })\r\n  fetchDeviceStatus({ productId: routerStore.productId, deviceId: ['*'] }).then(res => {\r\n    if (res.code === 200) {\r\n      onlineDevice.value = 0\r\n      res.data.forEach(item => {\r\n        if (item.deviceStatus === '在线') {\r\n          onlineDevice.value += 1\r\n        }\r\n      })\r\n    }\r\n  })\r\n  fetchUploadDeviceCount(params).then(res => {\r\n    if (res.code === 200) {\r\n      uploadDataDevice.value = res.data.todayUploadDevice\r\n      todayUploadData.value = res.data.datalist[7].newCount\r\n      uploadDataTotalCount.value = res.data.datalist[0].totalCount\r\n    }\r\n  })\r\n}\r\n\r\nfunction initPage() {\r\n  getProductInfo()\r\n  if (!deviceConnect.value.classList.contains('tag-active')) {\r\n    deviceConnect.value.classList.add('tag-active')\r\n  }\r\n  initData()\r\n}\r\n\r\nlet timer\r\nfunction getDataTimer() {\r\n  initData()\r\n  timer = setTimeout(getDataTimer, 10 * 1000)\r\n}\r\nonMounted(() => {\r\n  initPage()\r\n  getDataTimer()\r\n})\r\n\r\nonUnmounted(() => {\r\n  clearTimeout(timer)\r\n})\r\n\r\nfunction getProductInfo() {\r\n  isLoading.value = true\r\n  fetchProductData({ productId: routerStore.productId }).then(res => {\r\n    productData.productName = res.data.productName\r\n    productData.productId = res.data.productId\r\n    productData.productType = res.data.productType\r\n    productData.accessAgreement = res.data.accessAgreement\r\n    productData.deviceCount = res.data.deviceCount\r\n  }).finally(() => {\r\n    isLoading.value = false\r\n  })\r\n}\r\n\r\nconst isBrowse = ref(true)\r\nfunction handleOpenInfo() {\r\n  isBrowse.value = true\r\n  drawerSwitch.value = !drawerSwitch.value\r\n}\r\n\r\nconst drawerSwitch = ref(true)\r\n\r\nfunction handleOpenEdit() {\r\n  isBrowse.value = false\r\n  drawerSwitch.value = !drawerSwitch.value\r\n}\r\n\r\nconst deviceConnect = ref(null)\r\nconst deviceData = ref(null)\r\nconst chartTitle = ref('设备接入统计')\r\n\r\nfunction handleChangeOption(target, other, title) {\r\n  chartTitle.value = title\r\n  if (!target.classList.contains('tag-active')) {\r\n    target.classList.add('tag-active')\r\n  }\r\n  if (other.classList.contains('tag-active')) {\r\n    other.classList.remove('tag-active')\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.container-context {\r\n  background-color: white;\r\n  border: 1px solid #eeeeee;\r\n  border-radius: 5px;\r\n  padding: 2em;\r\n  margin-top: 1em;\r\n}\r\n.text-container-first.text-container-title, .text-container-first.text-container-content {\r\n  text-align: left;\r\n}\r\n.text-container-title, .text-container-content {\r\n  text-align: center;\r\n}\r\n.text-container-title.text-container-first {\r\n  font-weight: bold;\r\n  font-size: 1.5em;\r\n}\r\n.text-container-content.text-container-first>span {\r\n  font-size: 0.7em;\r\n  color: #409eff;\r\n  margin-right: 1em;\r\n}\r\n.text-container-title {\r\n  color: #666666;\r\n  font-weight: bold;\r\n}\r\n.text-container-content {\r\n  font-weight: bold;\r\n  font-size: 1.3em;\r\n}\r\n#container-option {\r\n  display: grid;\r\n  grid-template-columns: 5fr 1fr 5fr;\r\n  grid-template-areas: \"device space data\";\r\n}\r\n.container-info-device {\r\n  display: grid;\r\n  grid-template-columns: 3fr 1fr;\r\n  grid-template-rows: 1fr 1fr;\r\n  grid-template-areas: \"left right-top\"\r\n                       \"left right-bottom\";\r\n  text-align: center;\r\n}\r\n.container-info-device-left {\r\n  grid-area: left;\r\n}\r\n.container-info-device-right-top {\r\n  grid-area: right-top;\r\n}\r\n.container-info-device-right-bottom {\r\n  grid-area: right-bottom;\r\n}\r\n#container-connect-device {\r\n  grid-area: device;\r\n}\r\n#container-data-device {\r\n  grid-area: data;\r\n}\r\n.iconfont.icon-device, .iconfont.icon-data-device {\r\n  font-size: 5em;\r\n  color: #cccccc;\r\n}\r\n#container-connect-device:hover .iconfont.icon-device, #container-data-device:hover .iconfont.icon-data-device, .tag-active .iconfont.icon-data-device, .tag-active .iconfont.icon-device {\r\n  color: #57a2ff;\r\n  transition: all 300ms;\r\n}\r\n.tag-active {\r\n  box-shadow: 8px 8px 10px rgb(234, 235, 239);\r\n  transform: translate(0, -2px);\r\n}\r\nbr+span {\r\n  font-weight: bold;\r\n}\r\n#container-chart {\r\n  width: 100%;\r\n  height: auto;\r\n}\r\n</style>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=173d6202&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\javaWeb\\\\vuePro\\\\xin_gong_ke\\\\iot-page\\\\node_modules\\\\.pnpm\\\\vue-loader@16.8.3_5vqgdkn543z7gobmtemdwwisxa\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-173d6202\"]])\n\nexport default __exports__"],"sourceRoot":""}