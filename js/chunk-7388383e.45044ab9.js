(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7388383e"],{1469:function(e,t,a){"use strict";a("a47f")},2418:function(e,t,a){},"697d":function(e,t,a){"use strict";a.r(t);var c=a("3eb2"),n=a("7b4b"),d=a("9fc3"),o=a("815d"),i=a("3df8"),l=a("7b7b"),r=a("2095");const s={id:"container"},u={id:"filter-header"},b={id:"date-picker"},m={id:"count-select"};var p={__name:"lineChart",props:{extend:{type:Boolean,default:!0},dataStreamInfo:{type:Object,default(){return{}}}},setup(e){const t=e,a=Object(c["ref"])([]),n=Object(c["ref"])(!1);Object(c["watch"])(()=>t.extend,()=>{!0===t.extend&&(n.value=!0)});const i=Object(o["a"])(),p=Object(c["reactive"])({productId:i.productId,dataTemplateId:t.dataStreamInfo.dataTemplateId,dataName:t.dataStreamInfo.dataName,unitSymbols:t.dataStreamInfo.unitSymbols,unitName:t.dataStreamInfo.unitName}),f=Object(c["ref"])(null);let O;function j(e,{end:t=new Date,start:a=new Date(new Date-6048e5)}){n.value=!0;const c={xAxis:{data:[]},series:[{data:[]}]};Object(d["f"])({dataTemplateId:p.dataTemplateId,deviceId:i.deviceId,start:a,end:t}).then(t=>{200===t.code&&(c.xAxis.data=t.data.map(e=>Object(r["a"])(e.date)),c.series[0].data=t.data.map(e=>e.data),e.setOption(c))}).finally(()=>{n.value=!1})}function v(e){const t={tooltip:{trigger:"axis",axisPointer:{type:"cross"},valueFormatter:e=>e+p.unitSymbols},xAxis:{type:"category",boundaryGap:!1,name:"时间",data:[],nameTextStyle:{fontStyle:"italic",fontWeight:"bold",fontSize:15},axisLine:{symbol:["none","arrow"]}},yAxis:{type:"value",name:p.dataName+`(${p.unitSymbols})`,nameTextStyle:{fontStyle:"italic",fontWeight:"bold",fontSize:15},axisLine:{show:!0,symbol:["none","arrow"]}},series:[{data:[],name:p.dataName,type:"line",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#72c1e3"},{offset:1,color:"white"}]}},symbolSize:10,lineStyle:{width:6}}]};Object(d["f"])({dataTemplateId:p.dataTemplateId,deviceId:i.deviceId,start:new Date(new Date-6048e5),end:new Date}).then(a=>{200===a.code&&(t.xAxis.data=a.data.map(e=>Object(r["a"])(e.date)),t.series[0].data=a.data.map(e=>e.data),e.setOption(t))}).finally(()=>{n.value=!1})}function y(e){j(O,{start:new Date(e[0]),end:new Date(e[1])})}Object(c["onMounted"])(()=>{O=l["a"].init(f.value),v(O)});const h=Object(c["ref"])("");function N(e){if(""!==e){n.value=!0;const t={xAxis:{data:[]},series:[{data:[]}]};Object(d["e"])({deviceId:i.deviceId,dataTemplateId:p.dataTemplateId,count:e}).then(e=>{200===e.code&&(t.xAxis.data=e.data.map(e=>Object(r["a"])(e.date)),t.series[0].data=e.data.map(e=>e.data),O.setOption(t))}).finally(()=>{n.value=!1})}}return(e,t)=>{const d=Object(c["resolveComponent"])("el-date-picker"),o=Object(c["resolveComponent"])("el-option"),i=Object(c["resolveComponent"])("el-select"),l=Object(c["resolveDirective"])("loading");return Object(c["withDirectives"])((Object(c["openBlock"])(),Object(c["createElementBlock"])("div",s,[Object(c["createElementVNode"])("div",u,[Object(c["createElementVNode"])("div",b,[Object(c["createVNode"])(d,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),clearable:"",type:"datetimerange",size:"default","range-separator":"—","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"x",onChange:y},null,8,["modelValue"])]),Object(c["createElementVNode"])("div",m,[Object(c["createVNode"])(i,{modelValue:h.value,"onUpdate:modelValue":t[1]||(t[1]=e=>h.value=e),placeholder:"显示数据条数",style:{width:"115px"},clearable:"",onChange:N},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(o,{label:"10",value:10}),Object(c["createVNode"])(o,{label:"30",value:30}),Object(c["createVNode"])(o,{label:"50",value:50})]),_:1},8,["modelValue"])])]),Object(c["createElementVNode"])("div",{id:"device-line-chart-box",ref_key:"chart",ref:f},null,512)])),[[l,n.value]])}}},f=(a("8a89"),a("6dd4")),O=a.n(f);const j=O()(p,[["__scopeId","data-v-37f6f9eb"]]);var v=j;const y=e=>(Object(c["pushScopeId"])("data-v-201bc0d4"),e=e(),Object(c["popScopeId"])(),e),h={id:"container-box"},N={id:"header-info",class:"context-container"},w={class:"info-item"},x=y(()=>Object(c["createElementVNode"])("div",{class:"title-info-item text-info-item"},"设备数据总数(个)",-1)),S={class:"value-info-item text-info-item"},D={class:"info-item"},I=y(()=>Object(c["createElementVNode"])("div",{class:"title-info-item text-info-item"},"昨日新增(个)",-1)),V={class:"value-info-item text-info-item"},g={class:"info-item"},E=y(()=>Object(c["createElementVNode"])("div",{class:"title-info-item text-info-item"},"最近7日新增(个)",-1)),k={class:"value-info-item text-info-item"},T={id:"body-table-data",class:"context-container"},C={id:"pagination"};var _={__name:"dataStream",setup(e){Object(c["onMounted"])(()=>{l(),m()});const t=Object(c["reactive"])({deviceDataSum:0,yesterdayNew:0,weekNew:0}),a=Object(o["a"])();function l(){Object(n["d"])({productId:a.productId,deviceId:a.deviceId}).then(e=>{200===e.code&&(t.deviceDataSum=e.data.deviceDataSum,t.yesterdayNew=e.data.yesterdayNew,t.weekNew=e.data.weekNew)},e=>{console.log(e),Object(i["a"])({type:"error",message:"网络错误"})})}const s=Object(c["reactive"])([]),u=Object(c["ref"])(!1),b=Object(c["ref"])(0);function m(e=1,t=5){u.value=!0,Object(d["c"])({productId:a.productId,page:e,pageSize:t}).then(e=>{s.splice(0),s.push(...e.data.streamList),b.value=e.data.totalStream;const t=s.map(e=>e.dataTemplateId);Object(d["d"])({deviceId:a.deviceId,dataTemplateIdList:t}).then(e=>{for(const t in s)e.data[t].isNull?(s[t].latestData="暂无数据",s[t].uploadDate="暂无数据"):(s[t].latestData=e.data[t].latestData,s[t].uploadDate=Object(r["a"])(e.data[t].uploadDate))})}).finally(()=>{u.value=!1})}return(e,a)=>{const n=Object(c["resolveComponent"])("el-empty"),d=Object(c["resolveComponent"])("el-table-column"),o=Object(c["resolveComponent"])("el-table"),i=Object(c["resolveComponent"])("el-pagination"),l=Object(c["resolveDirective"])("loading");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",h,[Object(c["createElementVNode"])("div",N,[Object(c["createElementVNode"])("div",w,[x,Object(c["createElementVNode"])("div",S,Object(c["toDisplayString"])(t.deviceDataSum),1)]),Object(c["createElementVNode"])("div",D,[I,Object(c["createElementVNode"])("div",V,Object(c["toDisplayString"])(t.yesterdayNew),1)]),Object(c["createElementVNode"])("div",g,[E,Object(c["createElementVNode"])("div",k,Object(c["toDisplayString"])(t.weekNew),1)])]),Object(c["withDirectives"])((Object(c["openBlock"])(),Object(c["createElementBlock"])("div",T,[Object(c["createVNode"])(o,{data:s,style:{width:"100%"}},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(d,{type:"expand"},{default:Object(c["withCtx"])(({row:e})=>["暂无数据"===e.latestData?(Object(c["openBlock"])(),Object(c["createBlock"])(n,{key:0,description:"暂无数据"})):(Object(c["openBlock"])(),Object(c["createBlock"])(Object(c["unref"])(v),{key:1,"data-stream-info":e},null,8,["data-stream-info"]))]),_:1}),Object(c["createVNode"])(d,{prop:"dataName",label:"数据名称"}),Object(c["createVNode"])(d,{prop:"latestData",label:"最新数据值"}),Object(c["createVNode"])(d,{prop:"uploadDate",label:"最后更新时间"})]),_:1},8,["data"]),Object(c["createElementVNode"])("div",C,[Object(c["createVNode"])(i,{background:"",layout:"prev, pager, next",total:5,"page-size":5,onCurrentChange:a[0]||(a[0]=e=>m(e,5))})])])),[[l,u.value]])])}}};a("1469");const B=O()(_,[["__scopeId","data-v-201bc0d4"]]);t["default"]=B},"8a89":function(e,t,a){"use strict";a("2418")},"9fc3":function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"f",(function(){return d})),a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return l})),a.d(t,"e",(function(){return r}));var c=a("a27e");function n(e){return Object(c["a"])({url:"/api/data/fetchDataStream",method:"GET",params:e})}function d(e){return Object(c["a"])({url:"/api/data/fetchStreamData",method:"GET",params:e})}function o(e){return Object(c["a"])({url:"/api/data/fetchLatestData",method:"POST",data:e})}function i(e){return Object(c["a"])({url:"/api/data/addDataStream",method:"POST",data:e})}function l(e){return Object(c["a"])({url:"/api/data/deleteDataStream",method:"DELETE",params:e})}function r(e){return Object(c["a"])({url:"/api/data/fetchNewData",method:"GET",params:e})}},a47f:function(e,t,a){}}]);
//# sourceMappingURL=chunk-7388383e.45044ab9.js.map