(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-05151146"],{2095:function(e,t,c){"use strict";function a(e,t="YY-MM-DD hh:mm:ss"){const c=new Date(e),a=c.getFullYear(),n=c.getMonth()+1,o=c.getDate(),i=c.getHours(),d=c.getMinutes(),r=c.getSeconds(),l=Array.apply(null,Array(10)).map((function(e,t){return"0"+t}));return t.replace(/YY/g,a).replace(/MM/g,l[n]||n).replace(/DD/g,l[o]||o).replace(/hh/g,l[i]||i).replace(/mm/g,l[d]||d).replace(/ss/g,l[r]||r)}c.d(t,"a",(function(){return a}))},"32b3":function(e,t,c){"use strict";var a=c("3eb2");const n={id:"container-main-app-header"},o={id:"text-page-title"};var i={__name:"mainAppHeader",props:{pageTitle:{type:String,default:"temp"}},setup(e){const t=e;return(e,c)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",n,[Object(a["createElementVNode"])("span",o,Object(a["toDisplayString"])(t.pageTitle),1)]))}},d=(c("ce40"),c("6dd4")),r=c.n(d);const l=r()(i,[["__scopeId","data-v-4b858026"]]);t["a"]=l},"44fb":function(e,t,c){},"727f":function(e,t,c){"use strict";c.r(t);var a=c("3eb2"),n=c("32b3"),o=c("cced"),i=c("815d"),d=c("5500"),r=c("7b4b"),l=c("3df8"),u=c("2095");const b=e=>(Object(a["pushScopeId"])("data-v-6dc48376"),e=e(),Object(a["popScopeId"])(),e),s={id:"container-device-list"},O={id:"header-container",class:"container-context"},p={id:"count-device",class:"container-info"},j=b(()=>Object(a["createElementVNode"])("span",{class:"title-header"},Object(a["toDisplayString"])("设备总数"),-1)),m=b(()=>Object(a["createElementVNode"])("br",null,null,-1)),v={id:"count-online-device",class:"container-info"},f=b(()=>Object(a["createElementVNode"])("span",{class:"title-header"},Object(a["toDisplayString"])("在线设备"),-1)),h=b(()=>Object(a["createElementVNode"])("br",null,null,-1)),V={id:"id-product",class:"container-info"},N=b(()=>Object(a["createElementVNode"])("span",{class:"title-header"},Object(a["toDisplayString"])("产品ID"),-1)),g=b(()=>Object(a["createElementVNode"])("br",null,null,-1)),w={id:"action-area"},C=b(()=>Object(a["createElementVNode"])("span",null,"添加设备",-1)),x={id:"container-body",class:"container-context"},y=Object(a["createTextVNode"])("详情"),E=Object(a["createTextVNode"])("数据流"),I=Object(a["createTextVNode"])(" 更多操作 "),_=Object(a["createTextVNode"])("下发指令"),D=Object(a["createTextVNode"])(" 删除 "),T={id:"pagination"};var S={__name:"index",setup(e){const t=Object(a["ref"])(!0),c=Object(i["a"])(),b=Object(a["ref"])(c.productId),S=Object(a["reactive"])([]),k=Object(a["reactive"])([]);let A;function M(){$(),A=setTimeout(M,8e3)}Object(a["onMounted"])(()=>{G(),M()}),Object(a["onUnmounted"])(()=>{clearTimeout(A)});const B=Object(a["ref"])(0),U=Object(a["ref"])(0),z=Object(a["ref"])(!1);function G(e=1,t=8){z.value=!0,Object(r["g"])({productId:b.value,page:e,pageSize:t}).then(e=>{200===e.code?(B.value=e.data.total,U.value=0,e.data.devicelist&&(k.splice(0),e.data.devicelist.forEach(e=>{k.push(e.deviceId),e.lastOnlineTime=Object(u["a"])(e.lastOnlineTime),"在线"===e.deviceStatus&&(U.value++,e.lastOnlineTime="- - -")}),S.splice(0),S.push(...e.data.devicelist))):500===e.code&&(B.value=0,S.splice(0))},()=>{Object(l["a"])({type:"error",message:"网络错误"})}).finally(()=>{z.value=!1})}const Y=Object(d["d"])();function P(e,t){Y.push({name:t,params:{productId:c.productId,deviceId:S[e].deviceId}})}function $(){Object(r["h"])({productId:c.productId,deviceId:k}).then(e=>{200===e.code&&S.forEach(t=>{e.data.forEach(e=>{t.deviceId===e.deviceId&&(t.deviceStatus=e.deviceStatus,"在线"===t.deviceStatus?t.lastOnlineTime="- - -":t.lastOnlineTime=Object(u["a"])(e.lastOnlineTime))})})})}function F(e){z.value=!0,Object(r["c"])({productId:c.productId,deviceId:S[e].deviceId}).then(e=>{200===e.code&&(Object(l["a"])({type:"success",message:"删除成功"}),G())},()=>{Object(l["a"])({type:"error",message:"网络错误"})}).finally(()=>{z.value=!1})}return(e,c)=>{const i=Object(a["resolveComponent"])("ElementPlus"),d=Object(a["resolveComponent"])("el-icon"),r=Object(a["resolveComponent"])("el-button"),l=Object(a["resolveComponent"])("el-table-column"),u=Object(a["resolveComponent"])("el-tag"),k=Object(a["resolveComponent"])("arrow-down"),A=Object(a["resolveComponent"])("el-dropdown-item"),M=Object(a["resolveComponent"])("el-popconfirm"),Y=Object(a["resolveComponent"])("el-dropdown-menu"),$=Object(a["resolveComponent"])("el-dropdown"),J=Object(a["resolveComponent"])("el-table"),L=Object(a["resolveComponent"])("el-pagination"),q=Object(a["resolveDirective"])("loading");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",s,[Object(a["createVNode"])(Object(a["unref"])(o["a"]),{"drawer-switch":t.value,"drawer-title":"添加新设备",onOnUpdated:G},null,8,["drawer-switch"]),Object(a["createVNode"])(Object(a["unref"])(n["a"]),{"page-title":"设备列表"}),Object(a["createElementVNode"])("div",O,[Object(a["createElementVNode"])("div",p,[j,m,Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(B.value),1)]),Object(a["createElementVNode"])("div",v,[f,h,Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(U.value),1)]),Object(a["createElementVNode"])("div",V,[N,g,Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(b.value),1)]),Object(a["createElementVNode"])("div",w,[Object(a["createVNode"])(r,{type:"primary",onClick:c[0]||(c[0]=e=>t.value=!t.value)},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(d,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(i)]),_:1}),C]),_:1})])]),Object(a["createElementVNode"])("div",x,[Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createBlock"])(J,{data:S,style:{width:"100%"}},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(l,{prop:"deviceId",label:"设备ID",width:"180"}),Object(a["createVNode"])(l,{prop:"deviceName",label:"设备名称"}),Object(a["createVNode"])(l,{label:"设备状态",align:"center"},{default:Object(a["withCtx"])(e=>[Object(a["createVNode"])(u,{type:"在线"===e.row.deviceStatus?"":"info"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.row.deviceStatus),1)]),_:2},1032,["type"])]),_:1}),Object(a["createVNode"])(l,{prop:"lastOnlineTime",label:"最后在线时间"}),Object(a["createVNode"])(l,{label:"操作",align:"center"},{default:Object(a["withCtx"])(e=>[Object(a["createVNode"])(r,{link:"",type:"primary",size:"small",onClick:Object(a["withModifiers"])(t=>P(e.$index,"deviceInfo"),["prevent"])},{default:Object(a["withCtx"])(()=>[y]),_:2},1032,["onClick"]),Object(a["createVNode"])(r,{link:"",type:"primary",size:"small",onClick:Object(a["withModifiers"])(t=>P(e.$index,"dataStream"),["prevent"])},{default:Object(a["withCtx"])(()=>[E]),_:2},1032,["onClick"]),Object(a["createVNode"])($,{trigger:"click",placement:"bottom","hide-on-click":!1},{dropdown:Object(a["withCtx"])(()=>[Object(a["createVNode"])(Y,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(A,{onClick:Object(a["withModifiers"])(t=>P(e.$index,"command"),["prevent"])},{default:Object(a["withCtx"])(()=>[_]),_:2},1032,["onClick"]),Object(a["createVNode"])(A,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(M,{title:"确认删除?","confirm-button-type":"danger","confirm-button-text":"确认","cancel-button-text":"取消",onConfirm:t=>F(e.$index)},{reference:Object(a["withCtx"])(()=>[D]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(r,{link:"",type:"primary",size:"small"},{default:Object(a["withCtx"])(()=>[I,Object(a["createVNode"])(d,{class:"el-icon--right"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(k)]),_:1})]),_:1})]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[q,z.value]]),Object(a["createElementVNode"])("div",T,[Object(a["createVNode"])(L,{background:"",layout:"prev, pager, next",total:B.value,"page-size":7,onCurrentChange:c[1]||(c[1]=e=>G(e,7))},null,8,["total"])])])])}}},k=(c("f4a9"),c("6dd4")),A=c.n(k);const M=A()(S,[["__scopeId","data-v-6dc48376"]]);t["default"]=M},7904:function(e,t,c){},"7b4b":function(e,t,c){"use strict";c.d(t,"b",(function(){return n})),c.d(t,"g",(function(){return o})),c.d(t,"f",(function(){return i})),c.d(t,"h",(function(){return d})),c.d(t,"d",(function(){return r})),c.d(t,"c",(function(){return l})),c.d(t,"i",(function(){return u})),c.d(t,"e",(function(){return b})),c.d(t,"a",(function(){return s}));var a=c("a27e");function n(e){return Object(a["a"])({url:"/api/data/addDevice",method:"POST",data:e})}function o(e){return Object(a["a"])({url:"/api/data/fetchDeviceList",method:"GET",params:e})}function i(e){return Object(a["a"])({url:"/api/data/fetchDeviceInfo",method:"GET",params:e})}function d(e){return Object(a["a"])({url:"/api/data/fetchDeviceStatus",method:"POST",data:e})}function r(e){return Object(a["a"])({url:"/api/data/deviceDataUploadInfo",method:"GET",params:e})}function l(e){return Object(a["a"])({url:"/api/data/deleteDevice",method:"DELETE",params:e})}function u(e){return Object(a["a"])({url:"/api/data/sendCommand",method:"POST",data:e})}function b(e){return Object(a["a"])({url:"/api/data/fetchCommandList",method:"GET",params:e})}function s(e){return Object(a["a"])({url:"/api/data/addApiKey",month:"GET",params:e})}},cced:function(e,t,c){"use strict";var a=c("3eb2"),n=c("815d"),o=c("7b4b"),i=c("3df8");const d=Object(a["createElementVNode"])("hr",{color:"#e8eaec"},null,-1),r={style:{flex:"auto"}},l=Object(a["createTextVNode"])("取消"),u=Object(a["createTextVNode"])("确定");var b={__name:"editDrawer",props:{drawerSwitch:{type:Boolean,default:!0},drawerTitle:{type:String,default:"default_title"},deviceEditData:{type:Object,default(){return{}}}},emits:["onUpdated"],setup(e,{emit:t}){const c=e,b=Object(a["ref"])(!1),s=Object(a["ref"])(null),O=Object(a["ref"])("添加设备成功");Object(a["watch"])(()=>c.drawerSwitch,()=>{"{}"!==JSON.stringify(c.deviceEditData)?(j.deviceName=c.deviceEditData.deviceName,j.deviceAuthentication=c.deviceEditData.deviceAuthentication,j.deviceIntroduction=c.deviceEditData.deviceIntroduction,j.deviceId=c.deviceEditData.deviceId,O.value="更新信息成功"):(j.deviceId="",j.deviceName="",j.deviceAuthentication="",j.deviceIntroduction="",O.value="添加设备成功"),b.value=!0});const p=Object(n["a"])(),j=Object(a["reactive"])({productId:p.productId,deviceId:"",deviceName:"",deviceAuthentication:"",deviceIntroduction:""}),m=Object(a["reactive"])({deviceName:[{required:!0,message:"设备名不能为空",trigger:"blur"},{min:1,max:20,message:"长度须为1-20",trigger:"blur"}],deviceAuthentication:[{required:!0,message:"设备鉴权信息不能为空",trigger:"blur"},{min:6,max:24,message:"长度须为6-24",trigger:"blur"}],deviceIntroduction:[{min:0,max:50,message:"长度不能超过50个字符",trigger:"blur"}]});function v(){t("onUpdated")}const f=Object(a["ref"])(!1);function h(e){b.value=!1,f.value=!1,e.resetFields()}function V(){s.value.validate(e=>{e&&(f.value=!0,Object(o["b"])(j).then(e=>{200===e.code?(Object(i["a"])({type:"success",message:O.value}),v(),b.value=!1):Object(i["a"])({type:"error",message:"未知错误"})},()=>{Object(i["a"])({type:"error",message:"网络错误"})}).finally(()=>{f.value=!1}))})}return(t,c)=>{const n=Object(a["resolveComponent"])("el-input"),o=Object(a["resolveComponent"])("el-form-item"),i=Object(a["resolveComponent"])("el-form"),O=Object(a["resolveComponent"])("el-button"),p=Object(a["resolveComponent"])("el-drawer");return Object(a["openBlock"])(),Object(a["createBlock"])(p,{modelValue:b.value,"onUpdate:modelValue":c[4]||(c[4]=e=>b.value=e)},{header:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("h2",null,Object(a["toDisplayString"])(e.drawerTitle),1),d])]),default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(i,{ref_key:"deviceForm",ref:s,model:j,rules:m,"label-position":"top"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(o,{label:"设备名称",prop:"deviceName"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(n,{modelValue:j.deviceName,"onUpdate:modelValue":c[0]||(c[0]=e=>j.deviceName=e),placeholder:"1-20个字符"},null,8,["modelValue"])]),_:1}),Object(a["createVNode"])(o,{label:"鉴权信息",prop:"deviceAuthentication"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(n,{modelValue:j.deviceAuthentication,"onUpdate:modelValue":c[1]||(c[1]=e=>j.deviceAuthentication=e),placeholder:"6-24个字符"},null,8,["modelValue"])]),_:1}),Object(a["createVNode"])(o,{label:"设备描述",prop:"deviceIntroduction"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(n,{modelValue:j.deviceIntroduction,"onUpdate:modelValue":c[2]||(c[2]=e=>j.deviceIntroduction=e),placeholder:"1-50个字符"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),footer:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",r,[Object(a["createVNode"])(O,{onClick:c[3]||(c[3]=e=>h(s.value))},{default:Object(a["withCtx"])(()=>[l]),_:1}),Object(a["createVNode"])(O,{type:"primary",loading:f.value,onClick:V},{default:Object(a["withCtx"])(()=>[u]),_:1},8,["loading"])])]),_:1},8,["modelValue"])}}};const s=b;t["a"]=s},ce40:function(e,t,c){"use strict";c("44fb")},f4a9:function(e,t,c){"use strict";c("7904")}}]);
//# sourceMappingURL=chunk-05151146.ddc464d1.js.map